### <a name="_b7urdng99y53"></a>**Название задачи:** Настройка чтения с реплик и консистентность
### <a name="_hjk0fkfyohdk"></a>**Автор:** Щуренков Максим
### <a name="_uanumrh8zrui"></a>**Дата:** 13.11.2025

|**Коллекция**|**Операции чтения**|**Primary**|**Secondary**|**Допустимая задержка репликации, сек**|**Обоснование**|
| :- | :- | :- | :- | :- | :- |
|orders|Поиск истории заказов конкретного пользователя|-|+|10|История заказов - результат завершенного процесса, поэтому данных в них не должны изменяться. Из-за этого допустима задержка и не моментальная актуальность.|
|orders|Чтение статуса заказа (все кроме "оплачено")|-|+|5|Для отображения статуса пользователю допустима задержка, т.к. нет высоких требований к консистентности, а данные обновляются редко.|
|orders|Чтение статуса заказа ("оплачено")|+|-|0|Единственный статус, который необходимо читать без задержки и обеспечивать высокую консистентность. Не актуальный статус может привети к повторной оплате и негативному пользовательскому опыту|
|products|Чтение остатков по товару|+|-|0| Из-за задержки в репликации можно продать товар, которого уже в остатках, что критично для текущего бизнес-процесса и консистентности данных |
|products|Поиск товаров по категориям и фильтрация по диапазону цен|-|+|5|Категории и цены товаров меняются достаточно редко, а поиск - самая частая операция в нашем процессе.|
|products|Описание товара на странице продукта|-|+|5|Описание товара меняется достаточно редко, консистентность не критична.|
|products|Чтение цены товара|+|-|0|Во избежании ошибок и потенциальных убытков из-за ошибочных цен или недополучения прибыли по акционным товарам, а также для позитивного пользовательского опыта - цену необходимо держать всегда в актуальном состоянии, но только на этапе оформления заказа|
|carts|Получение текущей корзины (пользовательской и гостевой)|+|-|0|Частые изменения в корзине, слияние корзин и т.д. требуют консистентных данных для позитивного пользовательского опыта и избегания ошибок при добавлении/удалении товаров|


*Примечание*: 5 и 10 секунд выбраны исходя из собственного опыта и иследований. Считаем, что 5 секунд - максимальное задержка, когда пользователь не замечает расхождения отображаемых данных с фактическими, а для системы такая консистентность допустима. 10 секунд - заметная задержка для пользователя, но актуальность данных не критична, что также не должно вызывать негативный опыт.